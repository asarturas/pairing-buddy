version: 2
jobs:
  build:
    working_directory: /tmp/build
    docker:
      - image: spikerlabs/scala-sbt:scala-2.12.1-sbt-0.13.15
    steps:
      - checkout
      - setup_remote_docker
      - deploy:
          name: Maybe deploy
          command: |
            if [ "${CIRCLE_BRANCH}" == "master" ]; then
              apk add --no-cache docker
              docker login -u ${DOCKER_LOGIN} -p ${DOCKER_PASSWORD}
              sbt docker:publish
            fi